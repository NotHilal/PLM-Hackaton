<div class="employee-sidebar-pro">
  <!-- Search Section -->
  <div class="search-section">
    <div class="search-wrapper">
      <span class="search-icon">üîç</span>
      <input
        type="text"
        class="search-input"
        [value]="searchTerm()"
        (input)="onSearchChange($any($event.target).value)"
        placeholder="Rechercher par nom, qualification, poste, matricule...">
      <button
        *ngIf="searchTerm()"
        class="clear-btn"
        (click)="clearSearch()"
        title="Effacer">
        ‚úñ
      </button>
    </div>
  </div>

  <!-- Filters Section -->
  <div class="filters-section" *ngIf="dataService.employees().length > 0">
    <div class="filters-row">
      <div class="filter-item">
        <label class="filter-label">Qualification</label>
        <select
          class="filter-select"
          [value]="selectedQualification()"
          (change)="onQualificationChange($any($event.target).value)">
          <option value="all">Toutes</option>
          <option *ngFor="let qual of uniqueQualifications().slice(1)" [value]="qual">
            {{ qual }}
          </option>
        </select>
      </div>

      <div class="filter-item">
        <label class="filter-label">Exp√©rience</label>
        <select
          class="filter-select"
          [value]="selectedExperience()"
          (change)="onExperienceChange($any($event.target).value)">
          <option value="all">Tous</option>
          <option *ngFor="let exp of uniqueExperiences().slice(1)" [value]="exp">
            {{ exp }}
          </option>
        </select>
      </div>

      <div class="filter-item">
        <label class="filter-label">√Çge</label>
        <select
          class="filter-select"
          [value]="selectedAgeRange()"
          (change)="onAgeRangeChange($any($event.target).value)">
          <option value="all">Tous</option>
          <option value="18-30">18-30 ans</option>
          <option value="31-40">31-40 ans</option>
          <option value="41-50">41-50 ans</option>
          <option value="51+">51+ ans</option>
        </select>
      </div>

      <div class="filter-item">
        <label class="filter-label">Co√ªt Horaire</label>
        <select
          class="filter-select"
          [value]="selectedSalaryRange()"
          (change)="onSalaryRangeChange($any($event.target).value)">
          <option value="all">Tous</option>
          <option value="0-20">0-20‚Ç¨/h</option>
          <option value="21-35">21-35‚Ç¨/h</option>
          <option value="36-50">36-50‚Ç¨/h</option>
          <option value="51+">51+‚Ç¨/h</option>
        </select>
      </div>
    </div>

    <div class="filter-footer">
      <div class="results-count">
        <span class="count-badge">{{ filteredEmployees().length }}</span> employ√©(s)
      </div>
      <button
        *ngIf="hasActiveFilters()"
        class="clear-filters-btn"
        (click)="clearAllFilters()"
        title="R√©initialiser tous les filtres">
        üîÑ R√©initialiser
      </button>
    </div>
  </div>

  <!-- Empty State -->
  <div *ngIf="dataService.employees().length === 0" class="empty-state">
    <div class="empty-icon">üìÇ</div>
    <h3>Aucune donn√©e disponible</h3>
    <p>Veuillez charger un fichier ERP pour voir les employ√©s</p>
  </div>

  <!-- No Results State -->
  <div *ngIf="dataService.employees().length > 0 && filteredEmployees().length === 0" class="empty-state">
    <div class="empty-icon">üîç</div>
    <h3>Aucun r√©sultat trouv√©</h3>
    <p>Essayez de modifier vos crit√®res de recherche ou filtres</p>
    <button class="btn-secondary" (click)="clearAllFilters()">
      R√©initialiser tous les filtres
    </button>
  </div>

  <!-- Employees Grid -->
  <div *ngIf="dataService.employees().length > 0 && filteredEmployees().length > 0" class="employees-grid">
    <div *ngFor="let emp of filteredEmployees()" class="employee-card" (click)="openPopup(emp)">
      <div class="card-header">
        <div class="avatar" [style.background]="getExperienceColor(emp['Niveau d\'exp√©rience'])">
          {{ getInitials(emp['Pr√©nom'], emp['Nom']) }}
        </div>
        <div class="card-title">
          <h3 class="employee-name">{{ emp['Pr√©nom'] }} {{ emp['Nom'] }}</h3>
          <span class="employee-matricule">{{ emp['Matricule'] }}</span>
        </div>
      </div>
      <div class="card-body">
        <div class="info-row">
          <span class="info-icon">üíº</span>
          <span class="info-text">{{ emp['Qualification'] }}</span>
        </div>
        <div class="info-row">
          <span class="info-icon">üîß</span>
          <span class="info-text">{{ emp['Poste de montage'] }}</span>
        </div>
        <div class="info-row">
          <span class="info-icon">üìÖ</span>
          <span class="info-text">{{ emp['√Çge'] }} ans</span>
        </div>
        <div class="info-row">
          <span class="info-icon">üí∞</span>
          <span class="info-text">{{ emp['Co√ªt horaire (‚Ç¨)'] }}‚Ç¨/h</span>
        </div>
      </div>
      <div class="card-footer">
        <span class="badge" [style.background]="getExperienceColor(emp['Niveau d\'exp√©rience'])">
          {{ emp['Niveau d\'exp√©rience'] }}
        </span>
      </div>
    </div>
  </div>

  <!-- Enhanced Popup -->
  <div *ngIf="selectedEmployee()" class="popup-overlay" (click)="closePopup()">
    <div class="popup-content-pro" (click)="$event.stopPropagation()">
      <button class="close-btn-pro" (click)="closePopup()">‚úñ</button>

      <div class="popup-header">
        <div class="popup-avatar" [style.background]="getExperienceColor(selectedEmployee()['Niveau d\'exp√©rience'])">
          {{ getInitials(selectedEmployee()['Pr√©nom'], selectedEmployee()['Nom']) }}
        </div>
        <div class="popup-title-section">
          <h2>{{ selectedEmployee()['Pr√©nom'] }} {{ selectedEmployee()['Nom'] }}</h2>
          <p class="popup-subtitle">{{ selectedEmployee()['Qualification'] }}</p>
          <span class="badge-large" [style.background]="getExperienceColor(selectedEmployee()['Niveau d\'exp√©rience'])">
            {{ selectedEmployee()['Niveau d\'exp√©rience'] }}
          </span>
        </div>
      </div>

      <div class="popup-body">
        <div class="info-section">
          <h3>üìã Informations G√©n√©rales</h3>
          <div class="info-grid">
            <div class="info-item">
              <span class="info-label">Matricule</span>
              <span class="info-value">{{ selectedEmployee()['Matricule'] }}</span>
            </div>
            <div class="info-item">
              <span class="info-label">√Çge</span>
              <span class="info-value">{{ selectedEmployee()['√Çge'] }} ans</span>
            </div>
            <div class="info-item">
              <span class="info-label">Co√ªt horaire</span>
              <span class="info-value">{{ selectedEmployee()['Co√ªt horaire (‚Ç¨)'] }}‚Ç¨/h</span>
            </div>
            <div class="info-item">
              <span class="info-label">Rotation</span>
              <span class="info-value">{{ selectedEmployee()['Rotation'] }}</span>
            </div>
          </div>
        </div>

        <div class="info-section">
          <h3>üíº Poste & Comp√©tences</h3>
          <div class="info-item-full">
            <span class="info-label">Poste de montage</span>
            <span class="info-value">{{ selectedEmployee()['Poste de montage'] }}</span>
          </div>
          <div class="info-item-full">
            <span class="info-label">Description du poste</span>
            <span class="info-value">{{ selectedEmployee()['Description du poste'] }}</span>
          </div>
          <div class="info-item-full">
            <span class="info-label">Comp√©tences</span>
            <span class="info-value">{{ selectedEmployee()['Comp√©tences'] }}</span>
          </div>
          <div class="info-item-full">
            <span class="info-label">Habilitations</span>
            <span class="info-value">{{ selectedEmployee()['Habilitations'] }}</span>
          </div>
        </div>

        <div class="info-section">
          <h3>üìù Commentaire de Carri√®re</h3>
          <p class="career-comment">{{ selectedEmployee()['Commentaire de Carri√®re'] }}</p>
        </div>
      </div>
    </div>
  </div>
</div>
